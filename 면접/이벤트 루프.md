# ì´ë²¤íŠ¸ ë£¨í”„

> ì„¤ëª…ì€ ë¸Œë¼ìš°ì € ê¸°ì¤€ìœ¼ë¡œ í–ˆìŒ.

## ğŸ¤ª Event Loop?

- Event LoopëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì— ë™ì‹œì„±ì„ ì§€ì›.
- Call Stackê³¼ Callback Queueì˜ ìƒíƒœë¥¼ ì²´í¬í•˜ì—¬,**Call Stackì´ ë¹ˆ ìƒíƒœê°€ ë˜ë©´, Callback Queueì˜ ì²«ë²ˆì§¸ ì½œë°±ì„ Call Stackìœ¼ë¡œ ë°€ì–´ë„£ëŠ”ë‹¤**
- ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ìë°”ìŠ¤í¬ë¦½ê°€ êµ¬ë™ë˜ëŠ” í™˜ê²½ ì¦‰, ë¸Œë¼ìš°ì €ì— ìˆìŒ. NodeJSëŠ”Â `libuv`Â ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•´ì„œ ì´ë²¤íŠ¸ë£¨í”„ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

## ğŸ¤” ë¨¼ì € ì•Œì•„ì•¼í• ê²Œ ë§êµ°..

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ”Â **ì‹±ê¸€ ì“°ë ˆë“œ**Â ì–¸ì–´. ê·¸ëŸ¼Â **ì‹±ê¸€ ì“°ë ˆë“œ**Â ì–¸ì–´ì˜ íŠ¹ì§•ì€?

**ì½œ ìŠ¤íƒ(Call Stack)ì´ 1ê°œ**

- ë‹¤ë¥¸ë§ë¡œ 'ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸' > ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ê¶ê¸ˆí•˜ë‹¤ë©´?Â [ì—¬ê¸°](<https://doonguk.github.io/javascript/the-execution-context-(js)/>)Â ì°¸ê³ 
- ì½œìŠ¤íƒì€Â **ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ëŠ” ê³µê°„ ì¤‘ì˜ í•˜ë‚˜**ë¡œ, ì½”ë“œë¥¼ ì½ì–´ë‚´ë ¤ê°€ë©´ì„œ ìˆ˜í–‰í•  ì‘ì—…ë“¤ì„ ë°‘ì—ì„œë¶€í„° í•˜ë‚˜ì”© ìŒ“ê³ , ë©”ëª¨ë¦¬ í™ì—ì„œ ì‘ì—… ìˆ˜í–‰ì— í•„ìš”í•œ ê²ƒë“¤ì„ ì°¾ì•„ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê³µê°„ > ìì„¸í•œ ì„¤ëª…ì´ ê¶ê¸ˆí•˜ë‹¤ë©´?Â [ì—¬ê¸°](<vscode-webview-resource://11e2d440-0493-41e8-bc62-4d7b60f876b1/file///Users/woowahan15/Downloads/%5Bhttps://doonguk.github.io/javascript/%EB%A9%94%EB%AA%A8%EB%A6%AC-%ED%9E%99-&-%EC%BD%9C-%EC%8A%A4%ED%83%9D/%5D(https://doonguk.github.io/javascript/%EB%A9%94%EB%AA%A8%EB%A6%AC-%ED%9E%99-&-%EC%BD%9C-%EC%8A%A4%ED%83%9D/)>)Â ì°¸ê³ 
- ì½œ ìŠ¤íƒì´ 1ê°œë¼ëŠ” ëœ»ì€ í•œë²ˆì— í•˜ë‚˜ì˜ ì½”ë“œë§Œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»!

![https://user-images.githubusercontent.com/39187116/91078663-ed043d80-e67d-11ea-9c77-24326ed58587.png](https://user-images.githubusercontent.com/39187116/91078663-ed043d80-e67d-11ea-9c77-24326ed58587.png)

ìœ„ ì‚¬ì§„ì€ JS ì—”ì§„ì„ í‘œí˜„í•œ ê·¸ë¦¼ì´ì—ìš”. ëŒ€í‘œì ì¸ JSì—”ì§„ì€ í¬ë¡¬ V8ì´ ìˆì–´ìš”.

ê·¸ë¦¼ì„ ë³´ë©´ Objectí˜•ì„ ì €ì¥í•˜ëŠ” Heapê³¼ ì½œ ìŠ¤íƒìœ¼ë¡œ êµ¬í˜„ì´ ë˜ì–´ìˆêµ°ìš”.

```javascript
function foo() {
  throw new Error("oops!");
}

function bar() {
  foo();
}

function baz() {
  bar();
}

baz();
```

ê·¸ë˜ì„œ ì‹¤í–‰ì»¨í…ìŠ¤íŠ¸ë¥¼ ê°„ë‹¨í•˜ê²Œ í‘œí˜„í•˜ë©´ ì´ë ‡ê²Œ ìƒê¹€

![https://user-images.githubusercontent.com/39187116/91064196-eb307f00-e669-11ea-996b-7c54766654bf.png](https://user-images.githubusercontent.com/39187116/91064196-eb307f00-e669-11ea-996b-7c54766654bf.png)

## ğŸ˜¡ JS í”„ë¡œê·¸ë˜ë°ì—ì„œ 'ëŠë ¤ì§„ë‹¤'ëŠ” ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?

ì •í™•í•œ ê°œë…ì€ ì¡´ì¬í•˜ì§€ ì•Šì§€ë§ŒÂ **ëŠë¦° ë™ì‘ì´ ìŠ¤íƒì— ë‚¨ì•„ìˆëŠ” ê²ƒì„ ë³´í†µ ëŠë ¤ì§„ë‹¤(Blocking)**Â ë¼ê³  í•´ìš”. ì˜ˆë¥¼ë“¤ë©´Â **ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ê°™ì€ ì‘ì—…**( ì‹¤ì œë¡œëŠ” ë³´í†µ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬ë˜ì§€ë§Œ )ì´ ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤ë©´ ì˜¤ëœì‹œê°„ ë™ì•ˆ ì½œ ìŠ¤íƒì„ Blocking í•˜ê² ì£ 

ë¸Œë¼ìš°ì €ì—ì„œ JavascriptëŠ” ì´ëŸ° ë¬¸ì œë¥¼Â **ë¹„ë™ê¸° ì½œë°±(Asyncrouns callback)**Â ìœ¼ë¡œ í•´ê²°í•´ìš”.

![https://user-images.githubusercontent.com/39187116/91061344-08b01980-e667-11ea-8b22-ee1ea223358b.png](https://user-images.githubusercontent.com/39187116/91061344-08b01980-e667-11ea-8b22-ee1ea223358b.png)

![https://user-images.githubusercontent.com/39187116/91061175-d3a3c700-e666-11ea-9921-d490331d727b.png](https://user-images.githubusercontent.com/39187116/91061175-d3a3c700-e666-11ea-9921-d490331d727b.png)

ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•œë‹¤ëŠ” ê²ƒì€ ì‘ì—…ì— ëŒ€í•œ í–‰ìœ„ë¥¼ ë‹¤ë¥¸ ì£¼ì²´ì— ë§¡ê¸°ê³ , ì‘ì—…ì´ ëë‚˜ë©´ í•´ë‹¹ ì‘ì—…ì˜ ê²°ê³¼ê°’ì´ë‚˜ ë¯¸ë¦¬ ë“±ë¡í•´ ë†“ì€ ì½œë°±ì„ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì„ ë§í•´ìš”.

## ğŸ™„ ê·¸ëŸ¼ ìœ„ ì‚¬ì§„ì—ì„œ ì„œë²„ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ì€ ëˆ„ê°€ ë‹´ë‹¹í•˜ë‚˜ìš”?

ë°”ë¡œÂ **ë¸Œë¼ìš°ì €**ê°€ ë‹´ë‹¹í•´ìš”. ë¸Œë¼ìš°ì €ëŠ” ì›¹ì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—¬ëŸ¬ íš¨ê³¼ì ì¸ í–‰ë™ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡Â **Web Api**Â ë“¤ì„ ì œê³µí•´ìš”.

![https://user-images.githubusercontent.com/39187116/91077710-7fa3dd00-e67c-11ea-85c1-5905310e6746.png](https://user-images.githubusercontent.com/39187116/91077710-7fa3dd00-e67c-11ea-85c1-5905310e6746.png)

ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì€ ë¸Œë¼ìš°ì €ì—ì„œ ì œê³µí•˜ëŠ”Â `XMLHttpReqest API`ë¥¼ ì´ìš©í•´ìš”

**ë¸Œë¼ìš°ì €ê°€ ì œê³µí•˜ëŠ” APIëŠ” EcmaScript ê¸°ë°˜ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— js ì—”ì§„ì´ í•´ì„í•  ìˆ˜ ì—†ì–´ìš”.**Â "ë¸Œë¼ìš°ì €"ê°€ í•´ì„ì„ í•˜ì£ . ê·¸ë¦¬ê³ Â `xmlHttpRequest`Â ëŠ” ë¹„ë™ê¸° ì½œë°±ì„ ì§€ì›í•˜ëŠ” ë©”ì†Œë“œì—ìš”. ë”°ë¼ì„œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ë¸Œë¼ìš°ì €ì—ê²Œ ë„˜ê¸°ê³  JSì—”ì§„ì€ ë‹¤ìŒ ì‘ì—…ì„ ì‹¤í–‰í•˜ê²Œ ë¼ìš”.Â **ë§ˆì¹˜ ë©€í‹° ì“°ë ˆë“œì¸ ê²ƒ ì²˜ëŸ¼! (ë™ì‹œì„±ì„ ì§€ì›í•´ì¤Œ)**

## ğŸ¤£ ì˜ˆì‹œë¥¼ êµ­ë¯¼ ì˜ˆì‹œ, setTimeoutìœ¼ë¡œ ë°”ê¿” ë³¼ê²Œìš”..

ì§€ê¸ˆê¹Œì§€ ë§í–ˆë˜ ì˜ˆì‹œë¥¼Â `setTimeout`ìœ¼ë¡œ ì ìš©í•´ë³¼ê²Œìš”.

```javascript
setTimeout(() => console.log('ì•„ ì¡¸ë¦°ë‹¤. ìì†Œì„œ 6ë²ˆ ì–¸ì œì“°ì§€"), 10000)
```

1. ë¨¼ì €Â `setTimeout`Â í•¨ìˆ˜ê°€ ì‹¤í–‰ë¼ìš”. ê·¸ëŸ¼ Call Stackì—Â `setTimeout`Â í•¨ìˆ˜ê°€ ìŒ“ì´ê² ì£ 
2. `setTimeout`Â í•¨ìˆ˜ëŠ” EcmaScriptì— ì •ì˜ë˜ì§€ ì•Šê³  ë¹„ë™ê¸° ì½œë°±ì„ ì§€ì›í•˜ëŠ” Web API ì—ìš”. ë”°ë¼ì„œ ì½œë°±í•¨ìˆ˜

```javascript
() => console.log("ì•„ ì¡¸ë¦°ë‹¤. ìì†Œì„œ 6ë²ˆ ì–¸ì œì“°ì§€");
```

ë¥¼ ë¸Œë¼ìš°ì €ì—ê²Œ ë„˜ê¸°ê³ , ë¸Œë¼ìš°ì €ëŠ” ì—´ì‹¬íˆ íƒ€ì´ë¨¸ ì—°ì‚°ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. ( 10000ms )

1. ë¸Œë¼ìš°ì €ì—ê²Œ ì‘ì—…ì„ ë„˜ê¸´ ìˆœê°„ ì½œ ìŠ¤íƒì—ì„œÂ `setTimeout`Â í•¨ìˆ˜ëŠ” ì‚¬ë¼ì ¸ìš”.
2. ê·¸ëŸ¼ 10000msê°€ ì§€ë‚˜ë©´Â `() => console.log(~)`Â ë¥¼ ì–´ë–»ê²Œ ì‹¤í–‰í• ê¹Œìš”? ë¸Œë¼ìš°ì €ëŠ” íƒ€ì´ë¨¸ ì—°ì‚°ì´ ëë‚˜ë©´ ì½œë°± í•¨ìˆ˜ë¥¼ ë°”ë¡œ ì½œ ìŠ¤íƒìœ¼ë¡œ ë³´ë‚´ì§€ ì•Šê³ Â **Callback Queue**Â ë¼ëŠ” ê³³ì— ë„£ì–´ìš”.

> Callback QueueëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ëŸ°íƒ™ì„ì— ì¡´ì¬í•˜ëŠ” Queueì˜ í•œ ì¢…ë¥˜ì—ìš”. ë¸Œë¼ìš°ì €ê°€ ì²˜ë¦¬í•œ ì‘ì—…ì— ë“±ë¡ëœ Callback ë©”ì†Œë“œë¥¼ ë“¤ì–´ì˜¨ ìˆœì„œëŒ€ë¡œ ë³´ê´€í•˜ê³  ìˆì–´ìš”.

## ğŸ˜ª ì§€ê¸ˆê¹Œì§€ ì´ì•¼ê¸°ë¥¼ í•œì¥ì˜ ê·¸ë¦¼ìœ¼ë¡œ í‘œí˜„í•˜ë©´..

![https://user-images.githubusercontent.com/39187116/91110728-a6343900-e6b9-11ea-8691-bc5127a556ac.png](https://user-images.githubusercontent.com/39187116/91110728-a6343900-e6b9-11ea-8691-bc5127a556ac.png)

ë“œë””ì–´ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë³´ì´ëŠ”êµ°ìš”....

## ğŸ˜© ì´ë²¤íŠ¸ ë£¨í”„

ìœ„ì—ì„œ ì„ ì–¸í–ˆë˜ ì´ë²¤íŠ¸ ë£¨í”„ ì„¤ëª…ì„ ë‹¤ì‹œ ë³¼ê¹Œìš”?

> Call Stackê³¼ Callback Queueì˜ ìƒíƒœë¥¼ ì²´í¬í•˜ì—¬,Call Stackì´ ë¹ˆ ìƒíƒœê°€ ë˜ë©´, Callback Queueì˜ ì²«ë²ˆì§¸ ì½œë°±ì„ Call Stackìœ¼ë¡œ ë°€ì–´ë„£ëŠ”ë‹¤

**ì¦‰ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ì½œë°± íì— ìŒ“ì¸ í•¨ìˆ˜ë¥¼ ì½œ ìŠ¤íƒìœ¼ë¡œ ë„£ì–´ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ”êµ°..ğŸ¤”**Â ë‹¨.. ì½œ ìŠ¤íƒì´ ë¹„ì–´ìˆì„ ë•Œ!

ì„¤ëª…ì„ ìœ„í•´ ë‹¤ë¥¸ì˜ˆì œë¥¼ ì¤€ë¹„í–ˆëŠ”ë°ìš”

```javascript
function delay() {
  for (var i = 0; i < 100000; i++);
}
function foo() {
  delay();
  bar();
  console.log("foo!"); // (3)
}
function bar() {
  delay();
  console.log("bar!"); // (2)
}
function baz() {
  console.log("baz!"); // (4)
} // callback function

setTimeout(baz, 10); // (1)
foo();
```

ìœ„ ìƒí™©ì—ì„œÂ `setTimeout`Â í•¨ìˆ˜ëŠ” 10ms í›„ì— ì‹¤í–‰ëœë‹¤ê³  ì˜ˆìƒí•˜ê² ì£ ?

ê·¼ë°Â `foo`Â í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ ê·¸ ì•ˆì—ì„œÂ `delay`Â ì™€Â `bar`Â í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ì„œ ì½œ ìŠ¤íƒì´ ì—´ì‹¬íˆ ì¼ì„í•´ìš”.

ë¸Œë¼ìš°ì €ëŠ” ì§„ì‘ì—Â `setTimeout`Â í•¨ìˆ˜ì˜ íƒ€ì´ë¨¸ ì—°ì‚°ì„ ë§ˆì¹˜ê³ Â `baz`Â í•¨ìˆ˜ë¥¼ Callback Queueì— ë„£ì—ˆê² ì£ .

ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ì´Â `baz`Â í•¨ìˆ˜ë¥¼ ì½œ ìŠ¤íƒì— ë³´ë‚´ê³  ì‹¶ì€ë°, JS ì—”ì§„ì´ ì—´ì‹¬íˆ ì¼í•˜ê³  ìˆìœ¼ë‹ˆê¹Œ ê°„ì„ ë´ìš”.

ê·¸ëŸ¬ë‹¤ê°€ ì–´ëŠìˆœê°„ ì½œ ìŠ¤íƒì´ empty í–ˆì„ ë•Œ, ì½œë°± íì— ìˆì—ˆë˜Â `baz`Â í•¨ìˆ˜ë¥¼ ì½œ ìŠ¤íƒì— ë³´ë‚´ì„œ ì²˜ë¦¬í•˜ê²Œ ë¼ìš”.

**ì—¬ê¸°ì„œ ì¶”ê°€ì ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆëŠ” ì ì€?**Â setTimeout(baz)

- setTimeout, setInterval í•¨ìˆ˜ì— 2ë²ˆì§¸ ê°’ìœ¼ë¡œ ì„¤ì •ëœ ê°’ì€ "ìµœì†Œ ëª‡ ms í›„ì— ì‹¤í–‰í•˜ê² ë‹¤~" ë§Œ ë³´ì¥í•œë‹¤. ì½œ ìŠ¤íƒì´ ë¹„ì–´ìˆì§€ ì•Šìœ¼ë©´ ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì§€ ëª»í•˜ë‹ˆê¹Œ!
  - ê·¼ë° ì¶”ê°€ì ìœ¼ë¡œ setTimeoutì˜ default ms ëŠ” 4ms. ë”°ë¼ì„œ 0ìœ¼ë¡œ ì„¤ì •í•´ë„ ì†Œìš©ì—†ìŒ^^;;
  - ![image-20200825122810463](/Users/woowahan14/Library/Application Support/typora-user-images/image-20200825122810463.png)
    - ì²˜ëŸ¼ ë‹¤ë¥¸ íƒ­ì— ìˆìœ¼ë©´ ìµœëŒ€ 1ì´ˆ. ë”°ë¼ì„œ 1ì´ˆ ë¯¸ë§Œìœ¼ë¡œ ì„¤ì •í•´ë„ ì†Œìš©ì—†ìŒ^^;;
  - ê·¼ë° 0ì´ˆë¡œ ë§Œë“œëŠ” ë°©ë²•ë„ ìˆìŒÂ [ì—¬ê¸°](https://dbaron.org/log/20100309-faster-timeouts)Â ì°¸ê³ 
- ë¸Œë¼ìš°ì €ì˜ ë Œë”ë§ë„ ë¹„ë™ê¸°ë¡œ ì‹¤í–‰ëœë‹¤ê³  í•´ìš”. ì½œ ìŠ¤íƒì´ ì˜ ë¹„ì›Œì§€ì§€ ì•ŠëŠ” ì½”ë“œë¥¼ ì§œë©´ ë Œë”ë§ì´ ì˜ ì•ˆë˜ê² ì£ ?

## ğŸ˜‡ Callback Queueì—ëŠ” ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆë‹¤.

[ì—¬ê¸°](<vscode-webview-resource://11e2d440-0493-41e8-bc62-4d7b60f876b1/file///Users/woowahan15/Downloads/%5Bhttps://velog.io/@thms200/Event-Loop-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%5D(https://velog.io/@thms200/Event-Loop-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84)>)Â ë¥¼ ì°¸ê³ í•˜ì.

## Reference

1. [https://sangcho.tistory.com/entry/ES5-Intro1-JavaScript-%ED%8A%B9%EC%A7%95](https://sangcho.tistory.com/entry/ES5-Intro1-JavaScript-%ED%8A%B9%EC%A7%95)
2. [https://velog.io/@thms200/Event-Loop-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84](https://velog.io/@thms200/Event-Loop-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84)
